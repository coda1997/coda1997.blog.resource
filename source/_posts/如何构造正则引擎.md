---
title: 如何构造正则引擎
date: 2017-10-15
categories: java
---

### 基本思路

学过编译原理的话，目前就有一种编译原理上的路子，通过分析正则表达式的字符串，进行词法分析，语法分析（构造DFA），语义分析等，构造一个强大的正则表达式引擎。

如果是不实现`|`的正则，十分的简单，但这里我想构造一个功能完备的正则表达式引擎，并且具有一定的速度，需要支持完整的正则文法，编写一个高效的one-pass正则编译器。

但一切基于实现最最基本的正则引擎，目前，在下也只完成了一小部分的功能，并且没有实现过多的高级特性。这些高级技巧今后会慢慢加上，这是一个长时间更新的项目。（目前准备试试求导方法）

<!--more-->

### NFA

为什么从NFA开始，因为之前的字符串处理有很多种方法，都有效，但目前并没有找到一个高效间洁的方法处理字符串——将正则转化为最最基本的正则语法。因此暂时跳过，以后补充

#### NFA构造

NFA相信学过编译原理的人都很熟悉，作为常用的递归或者循环的思想实现，它具有很多有趣的功能。现在使用NFA构造正则引擎是很常规的做法。

- 首先需要一个结构（类）来存放NFA中的状态和状态边。这里我采用了一种取巧的做法，约定俗成第n个边对应第n个状态边；例如：

  ```java
  NFANode node = new NFANode();
  NFAEdge edge = node.getEdges().get(i);
  NFANode deNode = node.getDsNode().get(i);
  //这里i个边对应当前状态输入i边能到达的状态
  ```

- //todo 2017年10月20日